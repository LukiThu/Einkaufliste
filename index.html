<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Gerichte & Einkaufsliste</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 2em;
      background: #f5f5f5;
    }
    h2 {
      margin-top: 2em;
    }
    .section {
      margin-bottom: 2em;
    }
    input, textarea {
      padding: 8px;
      margin-bottom: 10px;
      width: 100%;
      font-size: 1em;
    }
    button {
      padding: 8px 12px;
      font-size: 1em;
      margin-top: 5px;
    }
    ul {
      list-style: none;
      padding: 0;
    }
    li {
      background: white;
      border: 1px solid #ddd;
      padding: 10px;
      margin-bottom: 5px;
    }
  </style>
</head>
<body>
  <h1>üçΩÔ∏è Gerichte & Einkaufsliste</h1>

  <div class="section">
    <h2>Neues Gericht erstellen</h2>
    <input type="text" id="gerichtName" placeholder="Name des Gerichts (z.B. Chili con Carne)">
    <textarea id="zutaten" placeholder="Zutaten ‚Äì jeweils eine pro Zeile"></textarea>
    <button onclick="gerichtHinzufuegen()">‚ûï Gericht hinzuf√ºgen</button>
  </div>

  <div class="section">
    <h2>Gerichte ausw√§hlen</h2>
    <ul id="gerichteListe"></ul>
  </div>

  <div class="section">
    <h2>üõí Einkaufsliste</h2>
    <ul id="einkaufsliste"></ul>
  </div>

  <script>
    let gerichte = JSON.parse(localStorage.getItem('gerichte')) || [];

    function gerichtHinzufuegen() {
      const name = document.getElementById('gerichtName').value.trim();
      const zutatenText = document.getElementById('zutaten').value.trim();
      if (!name || !zutatenText) return;

      const zutaten = zutatenText.split('\n').map(z => z.trim()).filter(z => z);
      gerichte.push({ name, zutaten });
      document.getElementById('gerichtName').value = '';
      document.getElementById('zutaten').value = '';
      speichernUndAktualisieren();
    }

    function speichernUndAktualisieren() {
      localStorage.setItem('gerichte', JSON.stringify(gerichte));
      anzeigenGerichte();
      aktualisiereEinkaufsliste();
    }

    function anzeigenGerichte() {
      const liste = document.getElementById('gerichteListe');
      liste.innerHTML = '';
      gerichte.forEach((gericht, index) => {
        const li = document.createElement('li');
        li.innerHTML = `
          <label>
            <input type="checkbox" onchange="aktualisiereEinkaufsliste()" data-index="${index}">
            <strong>${gericht.name}</strong><br>
            <small>${gericht.zutaten.join(', ')}</small>
          </label>
        `;
        liste.appendChild(li);
      });
    }

    function aktualisiereEinkaufsliste() {
      const checkedBoxes = document.querySelectorAll('#gerichteListe input:checked');
      const zutatenMap = {};

      checkedBoxes.forEach(cb => {
        const gericht = gerichte[cb.dataset.index];
        gericht.zutaten.forEach(zutat => {
          zutatenMap[zutat] = (zutatenMap[zutat] || 0) + 1;
        });
      });

      const liste = document.getElementById('einkaufsliste');
      liste.innerHTML = '';
      Object.entries(zutatenMap).forEach(([zutat, anzahl]) => {
        const li = document.createElement('li');
        li.textContent = anzahl > 1 ? `${anzahl}x ${zutat}` : zutat;
        liste.appendChild(li);
      });
    }

    // Initiale Anzeige
    anzeigenGerichte();
    aktualisiereEinkaufsliste();
  </script>
</body>
</html>
